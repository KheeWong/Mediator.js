/*!
* Mediator.js Library v0.10.1
* https://github.com/ajacksified/Mediator.js
*
* Copyright 2018, Jack Lawson
* MIT Licensed (http://www.opensource.org/licenses/mit-license.php)
*
* For more information: http://thejacklawson.com/2011/06/mediators-for-modularized-asynchronous-programming-in-javascript/index.html
* Project on GitHub: https://github.com/ajacksified/Mediator.js
*
* Last update: 22 Mar 2018
*/
!function(t,s){"use strict";"function"==typeof define&&define.amd?define([],function(){return t.Mediator=s(),t.Mediator}):"undefined"!=typeof exports?exports.Mediator=s():t.Mediator=s()}(this,function(){"use strict";function t(s,i,e){if(!(this instanceof t))return new t(s,i,e);var r;this.id=(r=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)})()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r(),this.fn=s,this.options=i,this.context=e,this.channel=null}function s(t,i){if(!(this instanceof s))return new s(t);this.namespace=t||"",this._subscribers=[],this._channels={},this._parent=i,this.stopped=!1}function i(){if(!(this instanceof i))return new i;this._channels=new s("")}return t.prototype.update=function(t){t&&(this.fn=t.fn||this.fn,this.context=t.context||this.context,this.options=t.options||this.options,this.channel&&this.options&&void 0!==this.options.priority&&this.channel.setPriority(this.id,this.options.priority))},s.prototype.addSubscriber=function(s,i,e){var r=new t(s,i,e);return i&&void 0!==i.priority?(i.priority=i.priority>>0,i.priority<0&&(i.priority=0),i.priority>=this._subscribers.length&&(i.priority=this._subscribers.length-1),this._subscribers.splice(i.priority,0,r)):this._subscribers.push(r),r.channel=this,r},s.prototype.stopPropagation=function(){this.stopped=!0},s.prototype.getSubscriber=function(t){for(var s=0,i=this._subscribers.length;s<i;s++)if(this._subscribers[s].id===t||this._subscribers[s].fn===t)return this._subscribers[s]},s.prototype.setPriority=function(t,s){var i,e,r,n,o=0,p=0;for(p=0,n=this._subscribers.length;p<n&&(this._subscribers[p].id!==t&&this._subscribers[p].fn!==t);p++)o++;i=this._subscribers[o],e=this._subscribers.slice(0,o),r=this._subscribers.slice(o+1),this._subscribers=e.concat(r),this._subscribers.splice(s,0,i)},s.prototype.addChannel=function(t){this._channels[t]=new s((this.namespace?this.namespace+":":"")+t,this)},s.prototype.hasChannel=function(t){return this._channels.hasOwnProperty(t)},s.prototype.returnChannel=function(t){return this._channels[t]},s.prototype.removeSubscriber=function(t){var s=this._subscribers.length-1;if(t)for(;s>=0;s--)this._subscribers[s].fn!==t&&this._subscribers[s].id!==t||(this._subscribers[s].channel=null,this._subscribers.splice(s,1));else this._subscribers=[]},s.prototype.publish=function(t){for(var s,i,e,r=0,n=this._subscribers.length,o=!1;r<n;r++)o=!1,s=this._subscribers[r],this.stopped||(i=this._subscribers.length,void 0!==s.options&&"function"==typeof s.options.predicate?s.options.predicate.apply(s.context,t)&&(o=!0):o=!0),o&&(s.options&&void 0!==s.options.calls&&(s.options.calls--,s.options.calls<1&&this.removeSubscriber(s.id)),s.fn.apply(s.context,t),n=e=this._subscribers.length,e===i-1&&r--);this._parent&&this._parent.publish(t),this.stopped=!1},i.prototype.getChannel=function(t,s){var i=this._channels,e=t.split(":"),r=0,n=e.length;if(""===t)return i;if(e.length>0)for(;r<n;r++){if(!i.hasChannel(e[r])){if(s)break;i.addChannel(e[r])}i=i.returnChannel(e[r])}return i},i.prototype.subscribe=function(t,s,i,e){return i=i||{},e=e||{},this.getChannel(t||"",!1).addSubscriber(s,i,e)},i.prototype.once=function(t,s,i,e){return(i=i||{}).calls=1,this.subscribe(t,s,i,e)},i.prototype.getSubscriber=function(t,s){var i=this.getChannel(s||"",!0);return i.namespace!==s?null:i.getSubscriber(t)},i.prototype.remove=function(t,s){var i=this.getChannel(t||"",!0);if(i.namespace!==t)return!1;i.removeSubscriber(s)},i.prototype.publish=function(t){var s=this.getChannel(t||"",!1);if(s.namespace!==t)return null;var i=Array.prototype.slice.call(arguments,1);i.push(s),s.publish(i)},i.prototype.on=i.prototype.subscribe,i.prototype.bind=i.prototype.subscribe,i.prototype.emit=i.prototype.publish,i.prototype.trigger=i.prototype.publish,i.prototype.off=i.prototype.remove,i.Channel=s,i.Subscriber=t,i.version="0.10.1",i});
